"""
데이터 수집 서비스 상수 정의

API URL, 브랜드 사전, 지역 정보 등
"""
from typing import Dict, List, Set

# ============================================================
# API 엔드포인트
# ============================================================

# 국토부 표준지역코드 API 엔드포인트
MOLIT_REGION_API_URL = "https://apis.data.go.kr/1741000/StanReginCd/getStanReginCdList"

# 국토부 아파트 목록 API 엔드포인트
MOLIT_APARTMENT_LIST_API_URL = "https://apis.data.go.kr/1613000/AptListService3/getTotalAptList3"

# 국토부 아파트 기본정보 API 엔드포인트
MOLIT_APARTMENT_BASIC_API_URL = "https://apis.data.go.kr/1613000/AptBasisInfoServiceV4/getAphusBassInfoV4"

# 국토부 아파트 상세정보 API 엔드포인트
MOLIT_APARTMENT_DETAIL_API_URL = "https://apis.data.go.kr/1613000/AptBasisInfoServiceV4/getAphusDtlInfoV4"

# 한국부동산원 API 엔드포인트
REB_DATA_URL = "https://www.reb.or.kr/r-one/openapi/SttsApiTblData.do"

# 국토부 아파트 매매 실거래가 API 엔드포인트 (JSON)
MOLIT_SALE_API_URL = "https://apis.data.go.kr/1613000/RTMSDataSvcAptTrade/getRTMSDataSvcAptTrade"

# 국토부 아파트 전월세 실거래가 API 엔드포인트 (JSON)
MOLIT_RENT_API_URL = "https://apis.data.go.kr/1613000/RTMSDataSvcAptRent/getRTMSDataSvcAptRent"

# ============================================================
# 지역 정보
# ============================================================

# 시도 목록 (17개)
CITY_NAMES = [
    "강원특별자치도",
    "경기도",
    "경상남도",
    "경상북도",
    "광주광역시",
    "대구광역시",
    "대전광역시",
    "부산광역시",
    "서울특별시",
    "세종특별자치시",
    "울산광역시",
    "인천광역시",
    "전라남도",
    "전북특별자치도",
    "제주특별자치도",
    "충청남도",
    "충청북도"
]

# ============================================================
# 대규모 브랜드 정규화 사전
# 
#  최우선 원칙: Zero False Positive
# - 브랜드가 다르면 즉시 거부(Veto)
# - Key의 길이가 긴 순서대로 매칭
# ============================================================

# Tier 1: 메이저 건설사
BRAND_DICT_TIER1: Dict[str, List[str]] = {
    "래미안": ["래미안", "RAEMIAN", "삼성물산", "삼성아파트", "삼성래미안"],
    "힐스테이트": ["힐스테이트", "HILLSTATE", "현대엔지니어링", "현대건설", "현대성우", "현대홈타운", "홈타운", "하이페리온"],
    "아이파크": ["아이파크", "IPARK", "I-PARK", "현대산업개발", "HDC"],
    "자이": ["자이", "XI", "LG자이", "엘지자이", "지에스", "GS건설"],
    "이편한세상": ["e편한세상", "이편한세상", "e-편한세상", "대림산업", "대림", "DL이앤씨", "아크로", "ACRO", "대림아파트"],
    "푸르지오": ["푸르지오", "PRUGIO", "대우건설", "대우아파트", "푸르지오써밋", "써밋"],
    "롯데캐슬": ["롯데캐슬", "LOTTECASTLE", "롯데낙천대", "롯데인벤스", "롯데아파트", "캐슬", "르엘"],
    "더샵": ["더샵", "THESHARP", "포스코", "포스코건설", "포스코더샵", "아델리스"],
    "SK뷰": ["SK뷰", "SKVIEW", "에스케이뷰", "SK건설", "SK아파트", "아펠바움"],
    "한화포레나": ["포레나", "FORENA", "꿈에그린", "한화건설", "한화아파트", "오벨리스크"],
    "두산위브": ["두산위브", "WEVE", "두산건설", "두산아파트", "더제니스"]
}

# Public: 공공 및 지자체 브랜드 (미스매칭 주의 구간)
BRAND_DICT_PUBLIC: Dict[str, List[str]] = {
    "LH": ["LH", "엘에이치", "주공", "주공아파트", "대한주택공사", "한국토지주택공사", "휴먼시아", "뜨란채", "천년나무", "안단테"],
    "SH": ["SH", "에스에이치", "서울주택도시공사", "도시개발아파트", "리엔파크"],
    "부영": ["부영", "사랑으로", "애시앙", "그린타운"]
}

# Tier 2: 중견/지방 건설사 및 기타 브랜드
BRAND_DICT_TIER2: Dict[str, List[str]] = {
    "호반베르디움": ["호반베르디움", "베르디움", "호반건설", "호반써밋", "VERDIUM"],
    "중흥S클래스": ["중흥S클래스", "중흥에스클래스", "중흥건설", "S-CLASS"],
    "우미린": ["우미린", "LYNN", "우미건설", "우미이노스빌"],
    "동부센트레빌": ["동부센트레빌", "센트레빌", "CENTREVILLE", "동부건설", "동부아파트"],
    "코오롱하늘채": ["코오롱하늘채", "하늘채", "코오롱", "코오롱아파트"],
    "금호어울림": ["금호어울림", "어울림", "금호건설", "리첸시아", "금호베스트빌"],
    "계룡리슈빌": ["계룡리슈빌", "리슈빌", "RICHEVILLE", "계룡건설"],
    "한라비발디": ["한라비발디", "비발디", "VIVALDI", "한라건설", "한라아파트"],
    "서희스타힐스": ["서희스타힐스", "스타힐스", "서희건설"],
    "KCC스위첸": ["KCC스위첸", "스위첸", "SWITZEN", "KCC건설"],
    "반도유보라": ["반도유보라", "유보라", "UBORA", "반도건설"],
    "양우내안애": ["양우내안애", "내안애", "양우건설"],
    "제일풍경채": ["제일풍경채", "풍경채", "제일건설"],
    "동원로얄듀크": ["동원로얄듀크", "로얄듀크", "비스타", "동원개발"],
    "대방노블랜드": ["대방노블랜드", "노블랜드", "디에트르", "대방건설"],
    "금강펜테리움": ["금강펜테리움", "펜테리움", "금강주택"],
    "한신더휴": ["한신더휴", "한신휴", "한신아파트", "한신공영"],
    "태영데시앙": ["태영데시앙", "데시앙", "DESIAN", "태영건설"],
    "쌍용예가": ["쌍용예가", "예가", "플래티넘", "쌍용건설", "쌍용아파트"],
    "IS동서": ["에일린의뜰", "IS동서", "아이에스동서"],
    "신동아": ["신동아", "파밀리에", "FAMILIE", "신동아아파트"],
    "한양수자인": ["한양수자인", "수자인", "SUJAIN", "한양아파트", "한양"],
    "벽산": ["벽산", "블루밍", "BLOOMING", "벽산아파트"],
    "풍림": ["풍림", "아이원", "IWANT", "풍림아파트"],
    "우성": ["우성", "우성아파트"],
    "한신": ["한신", "한신아파트"],
    "삼익": ["삼익", "삼익아파트", "삼익세라믹"],
    "라이프": ["라이프", "라이프아파트", "미성"],
    "건영": ["건영", "건영아파트", "캐스빌", "아모리움"],
    "경남": ["경남", "아너스빌", "HONORSVILLE", "경남아파트"],
    "현대": ["현대", "현대아파트"],
    "대우": ["대우", "대우아파트"],
    "삼성": ["삼성", "삼성아파트"],
    "동아": ["동아", "동아아파트", "동아솔레시티"],
    "럭키": ["럭키", "럭키아파트", "금성"],
    "임광": ["임광", "임광아파트"],
    "화성": ["화성", "화성아파트"],
    "대창": ["대창", "대창아파트"],
    "삼환": ["삼환", "삼환아파트"],
    "동성": ["동성", "동성아파트"],
    "동신": ["동신", "동신아파트"],
    "동양": ["동양", "동양아파트"],
    "서안": ["서안", "서안아파트"],
    "영풍": ["영풍", "영풍아파트"],
    "청구": ["청구", "청구아파트"],
    "태영": ["태영", "태영아파트"],
    "한진": ["한진", "한진아파트"],
    "금호": ["금호", "금호아파트"],
    "성지": ["성지", "성지아파트"],
    "서광": ["서광", "서광아파트"],
    "신안": ["신안", "신안아파트"],
    "삼호": ["삼호", "삼호아파트"],
    "극동": ["극동", "극동아파트"],
    "신일": ["신일", "신일아파트"],
    "쌍용": ["쌍용", "쌍용아파트"],
    "보람": ["보람", "보람아파트"],
    "한일": ["한일", "한일아파트"],
    "동문": ["동문", "동문아파트", "굿모닝힐"],
    "효성": ["효성", "효성아파트", "해링턴"],
    "삼부": ["삼부", "삼부아파트", "르네상스"],
    "진흥": ["진흥", "진흥아파트"],
    "대림": ["대림", "대림아파트"],
    "명성": ["명성", "명성아파트"],
    "세아": ["세아", "세아아파트"],
    "진로": ["진로", "진로아파트"],
    "유원": ["유원", "유원아파트"],
    "롯데": ["롯데", "롯데아파트"],
    "신성": ["신성", "신성아파트", "미소지움"],
    "두레": ["두레", "두레아파트"],
    "광명": ["광명", "광명아파트"],
    "경희": ["경희", "경희아파트"],
    "금강": ["금강", "금강아파트"],
    "대동": ["대동", "대동아파트"],
    "새서울": ["새서울", "새서울아파트"],
    "세경": ["세경", "세경아파트"],
    "월드": ["월드", "월드아파트"],
    "원광": ["원광", "원광아파트"],
    "천우": ["천우", "천우아파트"],
    "청솔": ["청솔", "청솔아파트"],
    "태광": ["태광", "태광아파트"],
    "한솔": ["한솔", "한솔아파트"],
    "한주": ["한주", "한주아파트"],
    "협진": ["협진", "협진아파트"],
    "화인": ["화인", "화인아파트"],
    "로얄": ["로얄", "로얄아파트"],
    "한빛": ["한빛", "한빛아파트"],
    "한휴": ["한휴", "한휴아파트", "한신휴플러스"],
}

# 모든 브랜드 사전 통합
def _build_brand_dict() -> Dict[str, List[str]]:
    """모든 브랜드 사전을 통합하여 반환"""
    result = {}
    result.update(BRAND_DICT_TIER1)
    result.update(BRAND_DICT_PUBLIC)
    result.update(BRAND_DICT_TIER2)
    return result

BRAND_DICT: Dict[str, List[str]] = _build_brand_dict()

# 브랜드 키워드 → 표준 브랜드명 역방향 매핑
def _build_brand_keyword_map() -> Dict[str, str]:
    """키워드에서 표준 브랜드명으로의 역방향 매핑 생성"""
    result = {}
    for standard_name, keywords in BRAND_DICT.items():
        for keyword in keywords:
            result[keyword.lower()] = standard_name
    return result

BRAND_KEYWORD_TO_STANDARD: Dict[str, str] = _build_brand_keyword_map()

# 브랜드 키워드 리스트 (길이 순 정렬 - 긴 것부터 매칭)
BRAND_KEYWORDS_SORTED: List[str] = sorted(
    BRAND_KEYWORD_TO_STANDARD.keys(),
    key=lambda x: len(x),
    reverse=True
)

# ============================================================
# 영문 ↔ 한글 브랜드명 변환
# ============================================================

BRAND_ENG_TO_KOR: Dict[str, str] = {
    'lg': '엘지',
    'sk': '에스케이',
    'gs': '지에스',
    'kt': '케이티',
    'kcc': '케이씨씨',
    'lh': '엘에이치',
    'sh': '에스에이치',
    'sr': '에스알',
    'am': '에이엠',
    'w': '더블유',
    'y': '와이',
    'e편한세상': '이편한세상',
    'metapolis': '메타폴리스',
    'wellga': '웰가',
    'view': '뷰',
    'city': '시티',
}

BRAND_KOR_TO_ENG: Dict[str, str] = {v: k for k, v in BRAND_ENG_TO_KOR.items()}

# ============================================================
# 로마 숫자 변환
# ============================================================

ROMAN_TO_INT: Dict[str, int] = {
    'Ⅰ': 1, 'Ⅱ': 2, 'Ⅲ': 3, 'Ⅳ': 4, 'Ⅴ': 5,
    'Ⅵ': 6, 'Ⅶ': 7, 'Ⅷ': 8, 'Ⅸ': 9, 'Ⅹ': 10,
    'ⅰ': 1, 'ⅱ': 2, 'ⅲ': 3, 'ⅳ': 4, 'ⅴ': 5,
    'ⅵ': 6, 'ⅶ': 7, 'ⅷ': 8, 'ⅸ': 9, 'ⅹ': 10,
    'I': 1, 'II': 2, 'III': 3, 'IV': 4, 'V': 5,
    'VI': 6, 'VII': 7, 'VIII': 8, 'IX': 9, 'X': 10,
    'i': 1, 'ii': 2, 'iii': 3, 'iv': 4, 'v': 5,
    'vi': 6, 'vii': 7, 'viii': 8, 'ix': 9, 'x': 10
}

# ============================================================
# 접미사 목록
# ============================================================

# 제거 대상 접미사
BUILDING_SUFFIXES: List[str] = [
    '아파트', 'APT', 'apt', '맨션', '빌라', '타운', '하이츠', '팰리스', 
    '파크', '시티', '주상복합', '연립', '오피스텔', '빌', '빌딩'
]

# 마을 이름 패턴 (정규화 시 마을 구분용)
VILLAGE_PATTERNS: List[str] = [
    '마을', '동네', '타운', '단지', '빌리지', '시티'
]

# ============================================================
# Veto (거부) 조건 관련 상수
# ============================================================

# 건축년도 허용 차이 (년)
BUILD_YEAR_TOLERANCE: int = 3

# 유사도 점수 임계값
MATCHING_SCORE_THRESHOLD: float = 85.0

# 애매한 매칭 판정 점수 차이 (상위 1, 2위 차이)
AMBIGUOUS_MATCH_DIFF: float = 10.0

# ============================================================
# 점수 가중치
# ============================================================

# 지번 정확도 점수
SCORE_BUNJI_FULL_MATCH: float = 40.0  # 본번+부번 완전 일치
SCORE_BUNJI_PARTIAL_MATCH: float = 20.0  # 본번만 일치

# 이름 유사도 점수 (최대)
SCORE_NAME_SIMILARITY_MAX: float = 40.0

# 메타데이터 일치 점수
SCORE_METADATA_MATCH: float = 20.0
SCORE_DANJI_CHA_MATCH: float = 10.0
SCORE_YEAR_UNITS_MATCH: float = 10.0
