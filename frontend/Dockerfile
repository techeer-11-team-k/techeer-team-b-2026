# ============================================================
# ğŸ  ë¶€ë™ì‚° ë¶„ì„ í”Œë«í¼ - Frontend Dockerfile (Expo)
# ============================================================
# Expoë¥¼ ì‚¬ìš©í•˜ì—¬ ì›¹/ëª¨ë°”ì¼ í¬ë¡œìŠ¤ í”Œë«í¼ ê°œë°œ
# ============================================================

# Node.js 18 LTS ì‚¬ìš©
FROM node:18-alpine

# í™˜ê²½ë³€ìˆ˜ ì„¤ì •
ENV NODE_ENV=development \
    EXPO_NO_DOTENV=1

# ì‘ì—… ë””ë ‰í† ë¦¬ ì„¤ì •
WORKDIR /app

# Expo CLI ì „ì—­ ì„¤ì¹˜
RUN npm install -g expo-cli@latest

# íŒ¨í‚¤ì§€ íŒŒì¼ ë³µì‚¬ (ìºì‹± ìµœì í™”)
COPY package*.json ./

# ì˜ì¡´ì„± ì„¤ì¹˜
RUN if [ -f package-lock.json ]; then \
      npm ci; \
    elif [ -f package.json ]; then \
      npm install; \
    else \
      echo "âš ï¸  package.jsonì´ ì—†ìŠµë‹ˆë‹¤."; \
      exit 1; \
    fi

# ì• í”Œë¦¬ì¼€ì´ì…˜ ì½”ë“œ ë³µì‚¬
COPY . .

# í¬íŠ¸ ë…¸ì¶œ
# 3000: Expo ì›¹ ì„œë²„
# 8081: Metro bundler (ë„¤ì´í‹°ë¸Œ ì•±ìš©)
EXPOSE 3000 8081

# ê°œë°œ ì„œë²„ ì‹¤í–‰ (ì›¹ ëª¨ë“œ)
CMD ["npx", "expo", "start", "--web"]

# ============================================================
# ë‹¤ë¥¸ ì‹¤í–‰ ëª¨ë“œ (ì£¼ì„ ì²˜ë¦¬)
# ============================================================
# ë„¤ì´í‹°ë¸Œ ëª¨ë“œ (ëª¨ë°”ì¼ ì•±)
# CMD ["npx", "expo", "start"]

# í”„ë¡œë•ì…˜ ë¹Œë“œ (ì›¹)
# RUN npx expo export:web
# CMD ["npx", "serve", "web-build"]
