# ğŸ  ë¶€ë™ì‚° ë¶„ì„ í”Œë«í¼ ê¸°ìˆ  ë³´ê³ ì„œ

> **í”„ë¡œì íŠ¸ëª…**: SweetHome Premium Real Estate  
> **ë²„ì „**: 1.0.0  
> **ì‘ì„±ì¼**: 2026ë…„ 1ì›” 23ì¼

---

## ğŸ“‹ ëª©ì°¨

1. [í”„ë¡œì íŠ¸ ì•„í‚¤í…ì²˜ ê°œìš”](#1-í”„ë¡œì íŠ¸-ì•„í‚¤í…ì²˜-ê°œìš”)
2. [í”„ë¡ íŠ¸ì—”ë“œ ê¸°ìˆ  ìŠ¤íƒ](#2-í”„ë¡ íŠ¸ì—”ë“œ-ê¸°ìˆ -ìŠ¤íƒ)
3. [ë°±ì—”ë“œ ê¸°ìˆ  ìŠ¤íƒ](#3-ë°±ì—”ë“œ-ê¸°ìˆ -ìŠ¤íƒ)
4. [ë°ì´í„°ë² ì´ìŠ¤ ì•„í‚¤í…ì²˜](#4-ë°ì´í„°ë² ì´ìŠ¤-ì•„í‚¤í…ì²˜)
5. [ì™¸ë¶€ API ì—°ë™](#5-ì™¸ë¶€-api-ì—°ë™)
6. [ìºì‹± ì „ëµ](#6-ìºì‹±-ì „ëµ)
7. [AI/ML ê¸°ëŠ¥](#7-aiml-ê¸°ëŠ¥)
8. [DevOps ì¸í”„ë¼](#8-devops-ì¸í”„ë¼)
9. [ì„±ëŠ¥ ìµœì í™”](#9-ì„±ëŠ¥-ìµœì í™”)
10. [ë³´ì•ˆ ì•„í‚¤í…ì²˜](#10-ë³´ì•ˆ-ì•„í‚¤í…ì²˜)

---

## 1. í”„ë¡œì íŠ¸ ì•„í‚¤í…ì²˜ ê°œìš”

### 1.1 ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              Client Layer                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚   Web Browser    â”‚  â”‚  Mobile (React   â”‚  â”‚    Admin Panel   â”‚           â”‚
â”‚  â”‚  (React + Vite)  â”‚  â”‚     Native)      â”‚  â”‚                  â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                      â”‚                      â”‚
            â–¼                      â–¼                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              API Gateway Layer                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                   FastAPI Application (ASGI)                          â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚   â”‚
â”‚  â”‚  â”‚    GZip     â”‚ â”‚    CORS     â”‚ â”‚ Performance â”‚ â”‚   Cache     â”‚     â”‚   â”‚
â”‚  â”‚  â”‚ Middleware  â”‚ â”‚ Middleware  â”‚ â”‚  Middleware â”‚ â”‚ Middleware  â”‚     â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚              Prometheus Instrumentator                         â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              Service Layer                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚  Auth Svc  â”‚ â”‚Apartment   â”‚ â”‚ Dashboard  â”‚ â”‚ AI Service â”‚ â”‚  Data      â”‚â”‚
â”‚  â”‚  (Clerk)   â”‚ â”‚  Service   â”‚ â”‚  Service   â”‚ â”‚  (Gemini)  â”‚ â”‚ Collection â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              Data Layer                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚   PostgreSQL      â”‚  â”‚      Redis        â”‚  â”‚   External APIs   â”‚        â”‚
â”‚  â”‚   + PostGIS       â”‚  â”‚    (Cache)        â”‚  â”‚  (êµ­í† ë¶€, ì¹´ì¹´ì˜¤) â”‚        â”‚
â”‚  â”‚   (Primary DB)    â”‚  â”‚                   â”‚  â”‚                   â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì§€í–¥ ëª¨ë“ˆëŸ¬ ì•„í‚¤í…ì²˜

ë³¸ í”„ë¡œì íŠ¸ëŠ” **ëª¨ë†€ë¦¬ì‹ ì½”ë“œë² ì´ìŠ¤** ë‚´ì—ì„œ **ë„ë©”ì¸ ì£¼ë„ ì„¤ê³„(DDD)** ì›ì¹™ì„ ì ìš©í•œ ëª¨ë“ˆëŸ¬ ì•„í‚¤í…ì²˜ë¥¼ ì±„íƒí•˜ì˜€ìŠµë‹ˆë‹¤.

```
backend/app/
â”œâ”€â”€ api/v1/endpoints/     # API ì—”ë“œí¬ì¸íŠ¸ (Presentation Layer)
â”œâ”€â”€ services/             # ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ (Application Layer)
â”œâ”€â”€ crud/                 # ë°ì´í„° ì ‘ê·¼ ê°ì²´ (Repository Pattern)
â”œâ”€â”€ models/               # SQLAlchemy ORM ëª¨ë¸ (Domain Layer)
â”œâ”€â”€ schemas/              # Pydantic ìŠ¤í‚¤ë§ˆ (DTO)
â”œâ”€â”€ core/                 # í•µì‹¬ ì„¤ì • (Infrastructure)
â””â”€â”€ utils/                # ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜
```

---

## 2. í”„ë¡ íŠ¸ì—”ë“œ ê¸°ìˆ  ìŠ¤íƒ

### 2.1 í•µì‹¬ í”„ë ˆì„ì›Œí¬

| ê¸°ìˆ  | ë²„ì „ | ìš©ë„ |
|------|------|------|
| **React** | 19.2.3 | UI ì»´í¬ë„ŒíŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ |
| **TypeScript** | 5.8.2 | ì •ì  íƒ€ì… ì‹œìŠ¤í…œ |
| **Vite** | 6.2.0 | ì°¨ì„¸ëŒ€ ë¹Œë“œ ë„êµ¬ |
| **React Router DOM** | 7.12.0 | SPA ë¼ìš°íŒ… |

### 2.2 React 19 ìµœì‹  ê¸°ëŠ¥ í™œìš©

```typescript
// React 19ì˜ ìµœì‹  ê¸°ëŠ¥ í™œìš©
// - Automatic batching ê°œì„ 
// - Concurrent rendering ìµœì í™”
// - Suspense ê°œì„ 

// ì˜ˆì‹œ: MapExplorer.tsxì—ì„œì˜ ìµœì í™”ëœ ìƒíƒœ ê´€ë¦¬
const [mapApartments, setMapApartments] = useState<MapApartment[]>([]);
const [currentZoomLevel, setCurrentZoomLevel] = useState(7);
const [isLoadingMapData, setIsLoadingMapData] = useState(false);

// useCallbackì„ í†µí•œ ë©”ëª¨ì´ì œì´ì…˜ìœ¼ë¡œ ë¶ˆí•„ìš”í•œ ë¦¬ë Œë”ë§ ë°©ì§€
const loadMapData = useCallback(async (map: any) => {
  if (isLoadingRef.current) return;
  // ... ì§€ë„ ë°ì´í„° ë¡œë“œ ë¡œì§
}, [transactionType, clearAllOverlays, createRegionOverlay, createApartmentOverlay]);
```

### 2.3 ë°ì´í„° ì‹œê°í™” ë¼ì´ë¸ŒëŸ¬ë¦¬

#### Highcharts (v12.5.0)
- **ê³ ê¸‰ ì¸í„°ë™í‹°ë¸Œ ì°¨íŠ¸**: ë¶€ë™ì‚° ê°€ê²© ì¶”ì´, ê±°ë˜ëŸ‰ ë¶„ì„
- **ë°˜ì‘í˜• ì°¨íŠ¸ ë Œë”ë§**: ëª¨ë°”ì¼/ë°ìŠ¤í¬íƒ‘ ìµœì í™”
- **ì‹¤ì‹œê°„ ë°ì´í„° ì—…ë°ì´íŠ¸**: WebSocket ì§€ì› ê°€ëŠ¥ êµ¬ì¡°

#### Recharts (v3.6.0)
- **React ë„¤ì´í‹°ë¸Œ í†µí•©**: ì„ ì–¸ì  ì°¨íŠ¸ ì»´í¬ë„ŒíŠ¸
- **SVG ê¸°ë°˜ ë Œë”ë§**: ê³ í•´ìƒë„ ë””ìŠ¤í”Œë ˆì´ ì§€ì›

#### Lightweight Charts (v4.1.1)
- **ê¸ˆìœµ ì°¨íŠ¸ íŠ¹í™”**: ìº”ë“¤ìŠ¤í‹±, ë¼ì¸ ì°¨íŠ¸
- **ê²½ëŸ‰í™”**: ë²ˆë“¤ ì‚¬ì´ì¦ˆ ìµœì†Œí™” (< 50KB)

### 2.4 Kakao Maps SDK í†µí•©

```typescript
// hooks/useKakaoLoader.ts - ì»¤ìŠ¤í…€ í›… êµ¬í˜„
export const useKakaoLoader = (): UseKakaoLoaderReturn => {
  const [isLoaded, setIsLoaded] = useState(false);
  const [error, setError] = useState<Error | null>(null);
  
  const loadKakaoMaps = useCallback(() => {
    // ë™ì  ìŠ¤í¬ë¦½íŠ¸ ë¡œë”© with ìë™ ì¬ì‹œë„
    const script = document.createElement('script');
    script.src = `https://dapi.kakao.com/v2/maps/sdk.js?appkey=${apiKey}&libraries=services,clusterer,drawing&autoload=false`;
    script.async = true;
    
    // Kakao Mapsì˜ load() ì½œë°± íŒ¨í„´ í™œìš©
    window.kakao.maps.load(() => {
      setIsLoaded(true);
    });
  }, [retryCount]);
  
  return { isLoaded, error, isLoading, retry };
};
```

### 2.5 ì§€ë„ ê¸°ë°˜ ê°€ê²© ì‹œê°í™”

```typescript
// í™•ëŒ€ ë ˆë²¨ë³„ ë°ì´í„° íƒ€ì… ê²°ì • ì•Œê³ ë¦¬ì¦˜
// ì¹´ì¹´ì˜¤ë§µ: ë ˆë²¨ì´ ë‚®ì„ìˆ˜ë¡ í™•ëŒ€, ë†’ì„ìˆ˜ë¡ ì¶•ì†Œ
const getDataTypeByZoom = (zoomLevel: number): 'sigungu' | 'dong' | 'apartment' => {
  if (zoomLevel >= 8) return 'sigungu';  // ê´‘ì—­ ì‹œêµ°êµ¬ ë‹¨ìœ„
  if (zoomLevel >= 5) return 'dong';      // ë™ ë‹¨ìœ„
  return 'apartment';                      // ê°œë³„ ì•„íŒŒíŠ¸
};

// ê°€ê²©ëŒ€ë³„ ìƒ‰ìƒ ë§¤í•‘ (Heat Map ìŠ¤íƒ€ì¼)
const getPriceColor = (price: number, isRegion = false): string => {
  if (isRegion) {
    if (price >= 15) return 'rgba(30, 64, 175, 0.95)';   // 15ì–µ ì´ìƒ
    if (price >= 10) return 'rgba(37, 99, 235, 0.95)';   // 10ì–µ ì´ìƒ
    if (price >= 5) return 'rgba(59, 130, 246, 0.95)';   // 5ì–µ ì´ìƒ
    return 'rgba(96, 165, 250, 0.95)';                    // 5ì–µ ë¯¸ë§Œ
  }
  // ì•„íŒŒíŠ¸ë³„ ë” ì„¸ë¶„í™”ëœ ìƒ‰ìƒ ìŠ¤í™íŠ¸ëŸ¼
  if (price >= 20) return 'rgba(127, 29, 29, 0.95)';    // 20ì–µ ì´ìƒ - ì§„í•œ ë¹¨ê°•
  if (price >= 15) return 'rgba(185, 28, 28, 0.95)';    // 15ì–µ ì´ìƒ
  // ...
};
```

### 2.6 API í´ë¼ì´ì–¸íŠ¸ ì„¤ê³„

```typescript
// services/api.ts - ì—”í„°í”„ë¼ì´ì¦ˆê¸‰ API í´ë¼ì´ì–¸íŠ¸

// API ì„¤ì • ìƒìˆ˜ (íƒ€ì„ì•„ì›ƒ, ì¬ì‹œë„ ì „ëµ)
const API_CONFIG = {
  DEFAULT_TIMEOUT: 30000,
  MAX_RETRIES: 2,
  RETRY_DELAY: 1000,
  RETRYABLE_STATUS_CODES: [408, 429, 500, 502, 503, 504] as number[],
} as const;

// ì»¤ìŠ¤í…€ ì—ëŸ¬ í´ë˜ìŠ¤
export class ApiError extends Error {
  constructor(
    message: string,
    public readonly status: number,
    public readonly code?: string,
    public readonly details?: unknown
  ) {
    super(message);
    this.name = 'ApiError';
  }
  
  get isNetworkError(): boolean { return this.status === 0; }
  get isAuthError(): boolean { return this.status === 401 || this.status === 403; }
  get isServerError(): boolean { return this.status >= 500; }
}

// ì§€ìˆ˜ ë°±ì˜¤í”„(Exponential Backoff) ì¬ì‹œë„ ë¡œì§
const apiFetch = async <T>(path: string, options: RequestOptions = {}): Promise<T> => {
  for (let attempt = 1; attempt <= maxAttempts; attempt++) {
    try {
      const response = await fetchWithTimeout(url, requestInit, timeout);
      if (!response.ok && shouldRetry) {
        await delay(API_CONFIG.RETRY_DELAY * attempt); // ì§€ìˆ˜ ì¦ê°€
        continue;
      }
      return response.json() as Promise<T>;
    } catch (error) {
      // ì¬ì‹œë„ ê°€ëŠ¥í•œ ì—ëŸ¬ ì²˜ë¦¬
    }
  }
};
```

---

## 3. ë°±ì—”ë“œ ê¸°ìˆ  ìŠ¤íƒ

### 3.1 FastAPI í”„ë ˆì„ì›Œí¬

```python
# main.py - ê³ ì„±ëŠ¥ ASGI ì• í”Œë¦¬ì¼€ì´ì…˜

from fastapi import FastAPI
from fastapi.middleware.cors import CORSMiddleware
from fastapi.middleware.gzip import GZipMiddleware
from prometheus_fastapi_instrumentator import Instrumentator

app = FastAPI(
    title=settings.PROJECT_NAME,
    version=settings.VERSION,
    description="ë¶€ë™ì‚° ë°ì´í„° ë¶„ì„ ë° ì‹œê°í™” ì„œë¹„ìŠ¤ API",
    docs_url="/docs",      # Swagger UI
    redoc_url="/redoc",    # ReDoc
)

# GZip ì••ì¶• ë¯¸ë“¤ì›¨ì–´ (500 bytes ì´ìƒ ì‘ë‹µ ìë™ ì••ì¶•)
# í‰ê·  70-80% í¬ê¸° ê°ì†Œ íš¨ê³¼
app.add_middleware(GZipMiddleware, minimum_size=500)
```

### 3.2 ì»¤ìŠ¤í…€ ì„±ëŠ¥ ë¯¸ë“¤ì›¨ì–´

```python
# ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ ë° íƒ€ì„ì•„ì›ƒ ë¯¸ë“¤ì›¨ì–´
class PerformanceMiddleware(BaseHTTPMiddleware):
    """
    ê¸°ëŠ¥:
    - ìš”ì²­ ì²˜ë¦¬ ì‹œê°„ ì¸¡ì •
    - ëŠë¦° ìš”ì²­ ë¡œê¹… (> 5ì´ˆ)
    - ìš”ì²­ íƒ€ì„ì•„ì›ƒ ì²˜ë¦¬ (60ì´ˆ)
    """
    
    async def dispatch(self, request: Request, call_next):
        start_time = time.time()
        
        # íƒ€ì„ì•„ì›ƒ ì ìš© (asyncio.wait_for ì‚¬ìš©)
        timeout = REQUEST_TIMEOUT  # ê¸°ë³¸ 60ì´ˆ
        if "/news" in path or "/search" in path:
            timeout = 90.0  # ë‰´ìŠ¤/ê²€ìƒ‰ì€ 90ì´ˆ
        
        try:
            response = await asyncio.wait_for(
                call_next(request),
                timeout=timeout
            )
            
            duration = time.time() - start_time
            
            # ëŠë¦° ìš”ì²­ ë¡œê¹… (> 5ì´ˆ)
            if duration > SLOW_REQUEST_THRESHOLD:
                perf_logger.warning(f"ğŸ¢ ëŠë¦° ìš”ì²­: {method} {path} - {duration:.2f}ì´ˆ")
            
            # ì‘ë‹µ í—¤ë”ì— ì²˜ë¦¬ ì‹œê°„ ì¶”ê°€
            response.headers["X-Response-Time"] = f"{duration:.3f}s"
            return response
            
        except asyncio.TimeoutError:
            return JSONResponse(
                status_code=504,
                content={"detail": {"code": "GATEWAY_TIMEOUT", ...}}
            )
```

### 3.3 ìºì‹± í—¤ë” ì „ëµ

```python
# API ê²½ë¡œë³„ ìºì‹± ì „ëµ (CDN/ë¸Œë¼ìš°ì € ìºì‹œ ìµœì í™”)
class CacheHeaderMiddleware(BaseHTTPMiddleware):
    async def dispatch(self, request: Request, call_next):
        response = await call_next(request)
        
        if request.method == "GET":
            path = request.url.path
            
            # API ê²½ë¡œë³„ ì°¨ë“± ìºì‹± TTL
            if "/apartments/" in path and "/detail" in path:
                # ì•„íŒŒíŠ¸ ìƒì„¸ ì •ë³´: 30ë¶„ ìºì‹±
                response.headers["Cache-Control"] = "public, max-age=1800, s-maxage=1800"
            elif "/dashboard/" in path:
                # ëŒ€ì‹œë³´ë“œ ë°ì´í„°: 10ë¶„ ìºì‹±
                response.headers["Cache-Control"] = "public, max-age=600, s-maxage=600"
            elif "/news" in path:
                # ë‰´ìŠ¤: 30ë¶„ ìºì‹±
                response.headers["Cache-Control"] = "public, max-age=1800, s-maxage=1800"
            elif "/indicators/" in path:
                # ê¸ˆë¦¬/ì§€í‘œ: 1ì‹œê°„ ìºì‹±
                response.headers["Cache-Control"] = "public, max-age=3600, s-maxage=3600"
            
            # ETag ì§€ì› (ì¡°ê±´ë¶€ ìš”ì²­)
            response.headers["Vary"] = "Accept-Encoding, Authorization"
```

### 3.4 SQLAlchemy ë¹„ë™ê¸° ORM

```python
# models/apartment.py - SQLAlchemy 2.0 ìŠ¤íƒ€ì¼ ëª¨ë¸ ì •ì˜

from sqlalchemy import String, DateTime, Boolean, Integer, ForeignKey
from sqlalchemy.orm import Mapped, mapped_column, relationship

class Apartment(Base):
    """
    ì•„íŒŒíŠ¸ ê¸°ë³¸ ì •ë³´ í…Œì´ë¸”
    
    ê´€ê³„(Relationships):
    - region: State (N:1)
    - apart_detail: ApartDetail (1:1)
    - sales: Sale (1:N)
    - rents: Rent (1:N)
    - favorite_apartments: FavoriteApartment (1:N)
    - my_properties: MyProperty (1:N)
    """
    __tablename__ = "apartments"
    
    apt_id: Mapped[int] = mapped_column(
        Integer,
        primary_key=True,
        autoincrement=True,
        comment="PK"
    )
    
    region_id: Mapped[int] = mapped_column(
        Integer,
        ForeignKey("states.region_id"),
        nullable=False,
        comment="FK"
    )
    
    apt_name: Mapped[str] = mapped_column(
        String(100),
        nullable=False,
        index=True,  # ê²€ìƒ‰ ì†ë„ í–¥ìƒì„ ìœ„í•œ ì¸ë±ìŠ¤
        comment="ì•„íŒŒíŠ¸ ë‹¨ì§€ëª…"
    )
    
    # Lazy Loading vs Eager Loading ì „ëµ
    region = relationship("State", back_populates="apartments")
    apart_detail = relationship("ApartDetail", back_populates="apartment", uselist=False)
    sales = relationship("Sale", back_populates="apartment")
```

### 3.5 API ë¼ìš°í„° ì„¤ê³„

```python
# api/v1/router.py - ì¤‘ì•™ ì§‘ì¤‘ì‹ ë¼ìš°í„° ê´€ë¦¬

api_router = APIRouter()

# ì¸ì¦ API
api_router.include_router(
    auth.router,
    prefix="/auth",
    tags=["ğŸ” Auth (ì¸ì¦)"]
)

# ì•„íŒŒíŠ¸ API
api_router.include_router(
    apartments.router,
    prefix="/apartments",
    tags=["ğŸ  Apartment (ì•„íŒŒíŠ¸)"]
)

# ëŒ€ì‹œë³´ë“œ API (ì‹¤ì‹œê°„ í†µê³„)
api_router.include_router(
    dashboard.router,
    prefix="/dashboard",
    tags=["ğŸ“Š Dashboard (ëŒ€ì‹œë³´ë“œ)"]
)

# AI API (Gemini í†µí•©)
api_router.include_router(
    ai.router,
    prefix="/ai",
    tags=["ğŸ¤– AI (ì¸ê³µì§€ëŠ¥)"]
)

# ì§€ë„ API (PostGIS ê¸°ë°˜)
api_router.include_router(
    map.router,
    prefix="/map",
    tags=["ğŸ—ºï¸ Map (ì§€ë„)"]
)

# í†µê³„ API (RVOL, 4ë¶„ë©´ ë¶„ë¥˜)
api_router.include_router(
    statistics.router,
    prefix="/statistics",
    tags=["ğŸ“ˆ Statistics (í†µê³„)"]
)
```

---

## 4. ë°ì´í„°ë² ì´ìŠ¤ ì•„í‚¤í…ì²˜

### 4.1 PostgreSQL + PostGIS

```sql
-- PostGIS í™•ì¥ì„ í™œìš©í•œ ê³µê°„ ë°ì´í„° ì €ì¥
-- apart_details í…Œì´ë¸”ì˜ geometry ì»¬ëŸ¼

CREATE TABLE apart_details (
    apt_detail_id SERIAL PRIMARY KEY,
    apt_id INTEGER REFERENCES apartments(apt_id),
    road_address VARCHAR(200),
    jibun_address VARCHAR(200),
    geometry GEOMETRY(Point, 4326),  -- SRID 4326 (WGS84)
    -- ...
);

-- ê³µê°„ ì¸ë±ìŠ¤ ìƒì„± (R-Tree ê¸°ë°˜)
CREATE INDEX idx_apart_details_geometry 
ON apart_details USING GIST (geometry);
```

### 4.2 ê³µê°„ ì¿¼ë¦¬ ìµœì í™”

```python
# ë°˜ê²½ ë‚´ ì•„íŒŒíŠ¸ ê²€ìƒ‰ (PostGIS ST_DWithin í™œìš©)
from geoalchemy2 import functions as geo_func

async def get_nearby_apartments(
    lat: float, lng: float, radius_meters: int, limit: int
):
    """
    ST_DWithin + use_spheroid=True ì‚¬ìš©
    - êµ¬ë©´ ê±°ë¦¬ ê³„ì‚°ìœ¼ë¡œ ì •í™•í•œ ì¸¡ì§€í•™ì  ê±°ë¦¬ ì¸¡ì •
    - ì˜¤ì°¨: Â±1m ë¯¸ë§Œ
    """
    stmt = (
        select(
            ApartDetail,
            geo_func.ST_Distance(
                ApartDetail.geometry,
                func.ST_SetSRID(func.ST_MakePoint(lng, lat), 4326),
                use_spheroid=True
            ).label('distance_meters')
        )
        .where(
            geo_func.ST_DWithin(
                ApartDetail.geometry,
                func.ST_SetSRID(func.ST_MakePoint(lng, lat), 4326),
                radius_meters,
                use_spheroid=True
            )
        )
        .order_by('distance_meters')
        .limit(limit)
    )
```

### 4.3 ERD ì£¼ìš” í…Œì´ë¸”

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   states    â”‚â”€â”€â”€â”€<â”‚  apartments â”‚â”€â”€â”€â”€<â”‚    sales    â”‚
â”‚  (ì§€ì—­ ì •ë³´) â”‚     â”‚  (ì•„íŒŒíŠ¸)   â”‚     â”‚  (ë§¤ë§¤ ê±°ë˜) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                   â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
                   â”‚             â”‚
              â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”
              â”‚ apart   â”‚  â”‚  rents  â”‚
              â”‚ details â”‚  â”‚(ì „ì›”ì„¸) â”‚
              â”‚(ìƒì„¸ì •ë³´)â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  accounts   â”‚â”€â”€â”€â”€<â”‚  favorites  â”‚     â”‚ my_property â”‚
â”‚  (ì‚¬ìš©ì)   â”‚     â”‚ (ì¦ê²¨ì°¾ê¸°)  â”‚     â”‚ (ë‚´ ìì‚°)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 5. ì™¸ë¶€ API ì—°ë™

### 5.1 êµ­í† êµí†µë¶€ ê³µê³µë°ì´í„° API

```python
# ë°ì´í„° ìˆ˜ì§‘ ì„œë¹„ìŠ¤ (Rate Limit ì²˜ë¦¬ í¬í•¨)

class AptDetailCollectionService(DataCollectionServiceBase):
    async def fetch_apartment_basic_info(self, kapt_code: str, retries: int = 3):
        """
        êµ­í† ë¶€ APIì—ì„œ ì•„íŒŒíŠ¸ ê¸°ë³¸ì •ë³´ ê°€ì ¸ì˜¤ê¸°
        
        Rate Limit ì²˜ë¦¬:
        - 429 ì—ëŸ¬ ë°œìƒ ì‹œ ì§€ìˆ˜ ë°±ì˜¤í”„ (2ì´ˆ, 4ì´ˆ, 6ì´ˆ)
        - HTTP í´ë¼ì´ì–¸íŠ¸ í’€ ì¬ì‚¬ìš©
        """
        for attempt in range(retries):
            try:
                response = await client.get(MOLIT_APARTMENT_BASIC_API_URL, params=params)
                
                if response.status_code == 429:
                    wait_time = (attempt + 1) * 2  # ì§€ìˆ˜ ë°±ì˜¤í”„
                    logger.warning(f"âš ï¸ Rate Limit (429), {wait_time}ì´ˆ ëŒ€ê¸° í›„ ì¬ì‹œë„...")
                    await asyncio.sleep(wait_time)
                    continue
                
                response.raise_for_status()
                return response.json()
            except httpx.HTTPStatusError as e:
                # ì¬ì‹œë„ ë¡œì§
```

### 5.2 Kakao ì§€ë„/ê²€ìƒ‰ API

```python
# ì£¼ì†Œ â†’ ì¢Œí‘œ ë³€í™˜ (Geocoding)

async def address_to_coordinates(address: str) -> Optional[Tuple[float, float]]:
    """
    ì¹´ì¹´ì˜¤ REST APIë¥¼ ì‚¬ìš©í•œ ì§€ì˜¤ì½”ë”©
    
    Returns:
        (longitude, latitude) íŠœí”Œ ë˜ëŠ” None
    """
    url = "https://dapi.kakao.com/v2/local/search/address.json"
    headers = {"Authorization": f"KakaoAK {settings.KAKAO_REST_API_KEY}"}
    
    async with httpx.AsyncClient() as client:
        response = await client.get(url, headers=headers, params={"query": address})
        data = response.json()
        
        if data.get("documents"):
            doc = data["documents"][0]
            return (float(doc["x"]), float(doc["y"]))
    return None
```

### 5.3 ë„¤ì´ë²„ ë‰´ìŠ¤ í¬ë¡¤ë§

```python
# ë¶€ë™ì‚° ë‰´ìŠ¤ ìˆ˜ì§‘ (Naver Search API)

async def fetch_real_estate_news(keywords: List[str], limit: int = 20):
    """
    ë„¤ì´ë²„ ê²€ìƒ‰ APIë¥¼ í™œìš©í•œ ë¶€ë™ì‚° ë‰´ìŠ¤ ìˆ˜ì§‘
    
    - í‚¤ì›Œë“œ ê¸°ë°˜ ë‰´ìŠ¤ ê²€ìƒ‰
    - ë³¸ë¬¸ ìš”ì•½ ì¶”ì¶œ
    - ì¤‘ë³µ ì œê±° ë¡œì§
    """
    headers = {
        "X-Naver-Client-Id": settings.NAVER_CLIENT_ID,
        "X-Naver-Client-Secret": settings.NAVER_CLIENT_SECRET
    }
    # ...
```

---

## 6. ìºì‹± ì „ëµ

### 6.1 Redis ìºì‹± ì•„í‚¤í…ì²˜

```python
# core/redis.py - ElastiCache ìµœì í™” ì„¤ì •

# ë¹ ë¥¸ ì‹¤íŒ¨ë¥¼ ìœ„í•œ íƒ€ì„ì•„ì›ƒ ìµœì†Œí™”
MAX_CONNECTIONS = 10          # cache.t3.microìš©
SOCKET_TIMEOUT = 1.0          # ì†Œì¼“ íƒ€ì„ì•„ì›ƒ (ë¹ ë¥¸ ì‹¤íŒ¨)
CONNECT_TIMEOUT = 1.0         # ì—°ê²° íƒ€ì„ì•„ì›ƒ (ë¹ ë¥¸ ì‹¤íŒ¨)
HEALTH_CHECK_INTERVAL = 60    # í—¬ìŠ¤ ì²´í¬ ê°„ê²©
REDIS_RETRY_INTERVAL = 60.0   # Redis ì¬ì—°ê²° ì‹œë„ ê°„ê²©

async def get_redis_client(check_health: bool = False) -> Optional[Redis]:
    """
    Redis í´ë¼ì´ì–¸íŠ¸ ì‹±ê¸€í†¤ íŒ¨í„´
    
    ì„±ëŠ¥ ìµœì í™”:
    - ë¹ ë¥¸ ì‹¤íŒ¨ (íƒ€ì„ì•„ì›ƒ 1ì´ˆ)
    - ì—°ê²° ì‹¤íŒ¨ ì‹œ 60ì´ˆê°„ ì¬ì‹œë„ ì•ˆ í•¨ (graceful degradation)
    - ì¬ì‹œë„ ì—†ìŒ (retries=0)
    """
    global _redis_client, _redis_available, _redis_unavailable_since
    
    # Redisê°€ ë¹„í™œì„±í™”ëœ ê²½ìš°, ì¼ì • ì‹œê°„ í›„ì—ë§Œ ì¬ì‹œë„
    if not _redis_available:
        if current_time - _redis_unavailable_since < REDIS_RETRY_INTERVAL:
            return None  # ìºì‹œ ì—†ì´ ì§„í–‰
        _redis_available = True  # ì¬ì‹œë„ í—ˆìš©
    
    # ... ì—°ê²° ë¡œì§
```

### 6.2 ìºì‹œ í‚¤ ë„¤ì´ë° ì „ëµ

```python
# utils/cache.py - êµ¬ì¡°í™”ëœ ìºì‹œ í‚¤ ê´€ë¦¬

CACHE_NAMESPACE = "realestate"

def build_cache_key(*parts: str) -> str:
    """
    ë„¤ì„ìŠ¤í˜ì´ìŠ¤ íŒ¨í„´ì„ ì‚¬ìš©í•˜ì—¬ í‚¤ ì¶©ëŒ ë°©ì§€
    ì˜ˆ: "realestate:apartment:detail:apt:123"
    """
    key_parts = [CACHE_NAMESPACE] + [str(part) for part in parts]
    return ":".join(key_parts)

# ìºì‹œ í‚¤ í—¬í¼ í•¨ìˆ˜ë“¤
def get_favorite_apartments_cache_key(account_id: int, skip: int, limit: int) -> str:
    return build_cache_key("favorite", "apartments", "account", str(account_id), ...)

def get_apartment_summary_cache_key(apt_id: int) -> str:
    return build_cache_key("apartment", "summary", "apt", str(apt_id))

def get_nearby_comparison_cache_key(apt_id: int, months: int, radius_meters: int) -> str:
    return build_cache_key("apartment", "nearby_comparison", "apt", str(apt_id), ...)
```

### 6.3 Graceful Degradation

```python
# ìºì‹œ ì‹¤íŒ¨ ì‹œ ì„œë¹„ìŠ¤ ì¤‘ë‹¨ ì—†ì´ ì§„í–‰

async def get_from_cache(key: str) -> Optional[Any]:
    """
    ì„±ëŠ¥ ìµœì í™”:
    - íƒ€ì„ì•„ì›ƒ 1ì´ˆ (ë¹ ë¥¸ ì‹¤íŒ¨)
    - Redis ì—°ê²° ì‹¤íŒ¨ ì‹œ None ë°˜í™˜ (graceful degradation)
    - ê³¼ë„í•œ ë¡œê¹… ë°©ì§€ (10íšŒ ì‹¤íŒ¨ë§ˆë‹¤ 1íšŒ ë¡œê¹…)
    """
    global _cache_fail_count
    
    try:
        redis_client = await get_redis_client()
        if redis_client is None:
            return None  # Redis ë¹„í™œì„±í™” ì‹œ ìºì‹œ ì—†ì´ ì§„í–‰
        
        cached_value = await asyncio.wait_for(
            redis_client.get(key),
            timeout=CACHE_OPERATION_TIMEOUT  # 1ì´ˆ
        )
        
        _cache_fail_count = 0  # ì„±ê³µ ì‹œ ì¹´ìš´í„° ë¦¬ì…‹
        return json.loads(cached_value) if cached_value else None
        
    except asyncio.TimeoutError:
        _cache_fail_count += 1
        if _cache_fail_count % 10 == 1:  # ê³¼ë„í•œ ë¡œê¹… ë°©ì§€
            logger.debug(f"â±ï¸ ìºì‹œ ì¡°íšŒ íƒ€ì„ì•„ì›ƒ (í‚¤: {key})")
        return None
```

---

## 7. AI/ML ê¸°ëŠ¥

### 7.1 Google Gemini API í†µí•©

```python
# services/ai_service.py

class AIService:
    def __init__(self):
        self.api_key = settings.GEMINI_API_KEY
        self.base_url = "https://generativelanguage.googleapis.com/v1beta"
    
    async def generate_text(
        self,
        prompt: str,
        model: str = "gemini-2.5-flash",
        temperature: float = 0.7,
        max_tokens: Optional[int] = None
    ) -> str:
        """
        Gemini APIë¥¼ ì‚¬ìš©í•œ í…ìŠ¤íŠ¸ ìƒì„±
        
        ì„±ëŠ¥ ìµœì í™”:
        - timeout 10ì´ˆ (ì—°ê²° 3ì´ˆ)
        - ëª¨ë¸: gemini-2.5-flash (ë¹ ë¥¸ ì‘ë‹µ)
        - HTTP í´ë¼ì´ì–¸íŠ¸ íƒ€ì„ì•„ì›ƒ ìµœì í™”
        """
        timeout_config = httpx.Timeout(10.0, connect=3.0)
        
        async with httpx.AsyncClient(timeout=timeout_config) as client:
            response = await client.post(url, headers=headers, params=params, json=body)
            # ...
```

### 7.2 ìì—°ì–´ ê²€ìƒ‰ ì¿¼ë¦¬ íŒŒì‹±

```python
async def parse_search_query(self, query: str) -> Dict[str, Any]:
    """
    ìì—°ì–´ ê²€ìƒ‰ ì¿¼ë¦¬ë¥¼ êµ¬ì¡°í™”ëœ ê²€ìƒ‰ ì¡°ê±´ìœ¼ë¡œ ë³€í™˜
    
    ì˜ˆì‹œ:
    - "ê°•ë‚¨êµ¬ì— ìˆëŠ” 30í‰ëŒ€ ì•„íŒŒíŠ¸, ì§€í•˜ì² ì—­ì—ì„œ 10ë¶„ ì´ë‚´"
    - "ì „ì„¸ 5ì–µ ì´í•˜ ì‹ ì¶• ì•„íŒŒíŠ¸"
    
    Returns:
        {
            "location": "ê°•ë‚¨êµ¬",
            "min_area": 84.0,
            "max_area": 114.0,
            "subway_max_distance_minutes": 10,
            "max_deposit": 50000,  # ì „ì„¸ ë³´ì¦ê¸ˆ (ë§Œì›)
            "build_year_range": "ì‹ ì¶•",
            "parsed_confidence": 0.9
        }
    """
    prompt = self._build_search_parsing_prompt(query)
    
    response_text = await self.generate_text(
        prompt=prompt,
        model="gemini-2.5-flash",
        temperature=0.0,  # ì •í™•í•œ íŒŒì‹±ì„ ìœ„í•´ ìµœì € ì˜¨ë„
        max_tokens=800
    )
    
    # JSON íŒŒì‹± (ì¬ì‹œë„ ë¡œì§ í¬í•¨)
    parsed_data = self._parse_json_response(response_text)
    
    return {
        "location": parsed_data.get("location"),
        "min_area": parsed_data.get("min_area"),
        "max_area": parsed_data.get("max_area"),
        # í‰ìˆ˜ ë³€í™˜: 1í‰ = 3.3058ã¡
        # "30í‰ëŒ€" â†’ min_area: 84.0, max_area: 114.0
        # ...
    }
```

### 7.3 AI ë‚´ ì§‘ ì¹­ì°¬ê¸€ ìƒì„±

```python
async def generate_property_compliment(self, property_data: Dict[str, Any]) -> str:
    """
    ë‚´ ì§‘ì— ëŒ€í•œ ë§ì¶¤í˜• ì¹­ì°¬ê¸€ ìƒì„±
    
    ì…ë ¥ ë°ì´í„°:
    - ì•„íŒŒíŠ¸ëª…, ìœ„ì¹˜, ì „ìš©ë©´ì 
    - êµìœ¡ ì‹œì„¤, ì§€í•˜ì²  ì •ë³´
    - ì‚¬ìš©ì ë©”ëª¨
    
    í”„ë¡¬í”„íŠ¸ ì—”ì§€ë‹ˆì–´ë§:
    - ì§€ì—­/ë™ ì •ë³´ ê°•ì¡°
    - êµí†µ ì ‘ê·¼ì„± (í˜¸ì„ , ì—­ëª…, ì†Œìš”ì‹œê°„)
    - êµìœ¡ í™˜ê²½ (í•™êµëª…)
    - 300-400ì ë¶„ëŸ‰
    """
    prompt = self._build_compliment_prompt(property_data)
    
    compliment = await self.generate_text(
        prompt=prompt,
        model="gemini-2.5-flash",
        temperature=0.7,  # ì°½ì˜ì ì¸ ì¹­ì°¬ê¸€
        max_tokens=1000
    )
    
    return self._clean_compliment_response(compliment)
```

---

## 8. DevOps ì¸í”„ë¼

### 8.1 Docker Compose ë©€í‹° ì„œë¹„ìŠ¤ ì•„í‚¤í…ì²˜

```yaml
# docker-compose.yml

services:
  # PostgreSQL + PostGIS
  db:
    image: postgis/postgis:15-3.3
    volumes:
      - postgres_data:/var/lib/postgresql/data
      - ./backend/scripts/init_db.sql:/docker-entrypoint-initdb.d/01-init_schema.sql:ro
  
  # Redis ìºì‹œ
  redis:
    image: redis:7-alpine
    command: redis-server --appendonly yes
    healthcheck:
      test: ["CMD", "redis-cli", "ping"]
  
  # FastAPI Backend
  backend:
    build:
      context: ./backend
      dockerfile: Dockerfile
    environment:
      DATABASE_URL: postgresql+asyncpg://${POSTGRES_USER}:${POSTGRES_PASSWORD}@db:5432/${POSTGRES_DB}
      REDIS_URL: redis://redis:6379/0
    entrypoint: ["/bin/bash", "/app/scripts/docker_entrypoint.sh"]
    command: ["uvicorn", "app.main:app", "--host", "0.0.0.0", "--port", "8000", "--reload"]
  
  # Prometheus ë©”íŠ¸ë¦­ ìˆ˜ì§‘
  prometheus:
    image: prom/prometheus:latest
    volumes:
      - ./backend/monitoring/prometheus/prometheus.yml:/etc/prometheus/prometheus.yml:ro
    command:
      - '--storage.tsdb.retention.time=30d'
  
  # Grafana ì‹œê°í™”
  grafana:
    image: grafana/grafana:latest
    volumes:
      - ./backend/monitoring/grafana/provisioning:/etc/grafana/provisioning:ro
      - ./backend/monitoring/grafana/dashboards:/var/lib/grafana/dashboards:ro
```

### 8.2 GitHub Actions CI/CD

```yaml
# .github/workflows/backend-cd.yml

name: Backend CD - Deploy to EC2

on:
  push:
    branches: [main]
    paths:
      - 'backend/**'
      - 'docker-compose.prod.yml'

jobs:
  deploy:
    runs-on: ubuntu-latest
    
    steps:
      - name: Deploy to EC2
        run: |
          ssh -i ~/.ssh/ec2_key ${{ env.EC2_USER }}@${{ env.EC2_HOST }} << 'ENDSSH'
            # ìµœì‹  ì½”ë“œ ê°€ì ¸ì˜¤ê¸°
            git fetch origin
            git reset --hard origin/main
            
            # Docker Composeë¡œ ì¬ë°°í¬
            docker compose -f docker-compose.prod.yml up -d --build
            
            # í—¬ìŠ¤ ì²´í¬ (ìµœëŒ€ 20íšŒ ì¬ì‹œë„, 5ì´ˆ ê°„ê²©)
            MAX_RETRIES=20
            while [ $RETRY_COUNT -lt $MAX_RETRIES ]; do
              HTTP_CODE=$(curl -s -o /dev/null -w "%{http_code}" http://localhost:8000/health)
              if [ "$HTTP_CODE" = "200" ]; then
                echo "âœ… í—¬ìŠ¤ ì²´í¬ ì„±ê³µ!"
                break
              fi
              sleep 5
            done
          ENDSSH

      # Slack ë°°í¬ ì•Œë¦¼
      - name: Slack Notification
        if: always()
        run: |
          curl -X POST -H 'Content-type: application/json' \
            --data '{"text": "ğŸš€ ë°±ì—”ë“œ ë°°í¬ ${{ job.status }}"}' \
            "$SLACK_WEBHOOK_URL"
```

### 8.3 Prometheus ë©”íŠ¸ë¦­ ìˆ˜ì§‘

```python
# main.py - FastAPI Prometheus Instrumentator

from prometheus_fastapi_instrumentator import Instrumentator

instrumentator = Instrumentator(
    excluded_handlers=[
        "/metrics",   # ë©”íŠ¸ë¦­ ì—”ë“œí¬ì¸íŠ¸ ìì²´ëŠ” ì œì™¸
        "/health",    # í—¬ìŠ¤ ì²´í¬ ì œì™¸
        "/docs",      # Swagger ë¬¸ì„œ ì œì™¸
    ],
)

# ë©”íŠ¸ë¦­ ìˆ˜ì§‘ê¸° í™œì„±í™”
instrumentator.instrument(app).expose(app, endpoint="/metrics", include_in_schema=False)
```

### 8.4 Grafana ëŒ€ì‹œë³´ë“œ

```json
// monitoring/grafana/dashboards/api-performance-dashboard.json

{
  "title": "API Performance Dashboard",
  "panels": [
    {
      "title": "ìš”ì²­ ì²˜ë¦¬ ì‹œê°„ (p95)",
      "targets": [{
        "expr": "histogram_quantile(0.95, rate(http_request_duration_seconds_bucket[5m]))"
      }]
    },
    {
      "title": "ì´ˆë‹¹ ìš”ì²­ ìˆ˜ (RPS)",
      "targets": [{
        "expr": "rate(http_requests_total[1m])"
      }]
    },
    {
      "title": "ì—ëŸ¬ìœ¨",
      "targets": [{
        "expr": "sum(rate(http_requests_total{status=~\"5..\"}[5m])) / sum(rate(http_requests_total[5m]))"
      }]
    }
  ]
}
```

---

## 9. ì„±ëŠ¥ ìµœì í™”

### 9.1 ë¹„ë™ê¸° ë³‘ë ¬ ì²˜ë¦¬

```python
# ëŒ€ì‹œë³´ë“œ API - ì¿¼ë¦¬ ë³‘ë ¬ ì‹¤í–‰

async def get_dashboard_summary(transaction_type: str, months: int, db: AsyncSession):
    """
    asyncio.gatherë¥¼ ì‚¬ìš©í•œ ì¿¼ë¦¬ ë³‘ë ¬ ì‹¤í–‰ìœ¼ë¡œ ì„±ëŠ¥ í–¥ìƒ
    """
    # 4ê°œì˜ ì¿¼ë¦¬ë¥¼ ë™ì‹œì— ì‹¤í–‰
    price_trend_result, volume_trend_result, national_trend_result, regional_trend_result = \
        await asyncio.gather(
            db.execute(price_trend_stmt),
            db.execute(volume_trend_stmt),
            db.execute(national_trend_stmt),
            db.execute(regional_trend_stmt)
        )
    
    # ê²°ê³¼ ì²˜ë¦¬
    # ...
```

### 9.2 ë°ì´í„°ë² ì´ìŠ¤ ì¿¼ë¦¬ ìµœì í™”

```python
# ë³µí•© ì¸ë±ìŠ¤ í™œìš© ì¿¼ë¦¬

# ê°€ê²©ëŒ€ë³„ ì•„íŒŒíŠ¸ ë¶„í¬ (CASE ë¬¸ í™œìš©)
price_ranges = case(
    (price_field < 10000, "1ì–µ ë¯¸ë§Œ"),
    (and_(price_field >= 10000, price_field < 30000), "1ì–µ~3ì–µ"),
    (and_(price_field >= 30000, price_field < 50000), "3ì–µ~5ì–µ"),
    # ...
    else_="15ì–µ ì´ìƒ"
)

stmt = (
    select(
        price_ranges.label('price_range'),
        func.count(trans_table.trans_id).label('count'),
        func.avg(price_field).label('avg_price')
    )
    .join(Apartment, trans_table.apt_id == Apartment.apt_id)
    .where(base_filter)
    .group_by(price_ranges)
)
```

### 9.3 ì„œë²„ ì‹œì‘ ì‹œ ìºì‹œ í”„ë¦¬ë¡œë”©

```python
# í™ˆ í™”ë©´ ìºì‹± (ì„œë²„ ì‹œì‘ ì‹œ ë°±ê·¸ë¼ìš´ë“œ íƒœìŠ¤í¬)

async def preload_home_cache():
    """
    ì„œë²„ ì‹œì‘ ì‹œ í™ˆ í™”ë©´ ë° í†µê³„ ì§€í‘œë“¤ì„ ë¯¸ë¦¬ ìºì‹±
    TTL: 12ì‹œê°„ (43200ì´ˆ)
    """
    cache_tasks = [
        ("dashboard/summary", {"transaction_type": "sale", "months": 6}),
        ("dashboard/summary", {"transaction_type": "jeonse", "months": 6}),
        ("dashboard/rankings", {"transaction_type": "sale", "trending_days": 7}),
        ("statistics/summary", {"transaction_type": "sale", "current_period_months": 6}),
    ]
    
    async with AsyncSessionLocal() as db:
        for api_name, params in cache_tasks:
            # ìºì‹œ í”„ë¦¬ë¡œë“œ ì‹¤í–‰
            result = await get_dashboard_summary(db=db, **params)
            await set_to_cache(cache_key, result, ttl=43200)

# ì•± ì‹œì‘ ì‹œ ë°±ê·¸ë¼ìš´ë“œ íƒœìŠ¤í¬ë¡œ ì‹¤í–‰
@app.on_event("startup")
async def startup_event():
    asyncio.create_task(preload_home_cache())
```

---

## 10. ë³´ì•ˆ ì•„í‚¤í…ì²˜

### 10.1 Clerk ì¸ì¦ í†µí•©

```python
# core/clerk.py - Clerk JWT ê²€ì¦

from clerk_backend_api import Clerk
from clerk_backend_api.jwks_helpers import AuthenticateRequestOptions

async def verify_clerk_token(authorization: str) -> Optional[Dict]:
    """
    Clerk JWT í† í° ê²€ì¦
    
    - JWKS ê¸°ë°˜ ì„œëª… ê²€ì¦
    - í† í° ë§Œë£Œ ê²€ì‚¬
    - í´ë ˆì„ ì¶”ì¶œ
    """
    clerk = Clerk(bearer_auth=settings.CLERK_SECRET_KEY)
    
    # JWT ê²€ì¦
    request_state = clerk.authenticate_request(
        request=Request("GET", "https://example.com"),
        options=AuthenticateRequestOptions(
            secret_key=settings.CLERK_SECRET_KEY
        )
    )
    
    if request_state.is_signed_in:
        return request_state.payload
    return None
```

### 10.2 CORS ë³´ì•ˆ ì„¤ì •

```python
# í”„ë¡œë•ì…˜ í™˜ê²½ CORS ì„¤ì •

if settings.ALLOWED_ORIGINS:
    origins = [origin.strip() for origin in settings.ALLOWED_ORIGINS.split(",")]
    app.add_middleware(
        CORSMiddleware,
        allow_origins=origins,          # í—ˆìš©ëœ ì¶œì²˜ë§Œ
        allow_credentials=True,         # ì¿ í‚¤/ì¸ì¦ ì •ë³´ í¬í•¨ í—ˆìš©
        allow_methods=["*"],            # ëª¨ë“  HTTP ë©”ì„œë“œ í—ˆìš©
        allow_headers=["*"],            # ëª¨ë“  í—¤ë” í—ˆìš©
        expose_headers=["*"],           # í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì ‘ê·¼ ê°€ëŠ¥í•œ ì‘ë‹µ í—¤ë”
    )
```

### 10.3 í™˜ê²½ë³€ìˆ˜ ê´€ë¦¬

```python
# core/config.py - Pydantic Settings

class Settings(BaseSettings):
    """
    í™˜ê²½ë³€ìˆ˜ ì„¤ì • í´ë˜ìŠ¤
    âš ï¸ ë¯¼ê°í•œ ì •ë³´ëŠ” .env íŒŒì¼ì—ì„œ ê´€ë¦¬
    """
    # í•„ìˆ˜ í™˜ê²½ë³€ìˆ˜ (ì—†ìœ¼ë©´ ì•± ì‹œì‘ ì‹¤íŒ¨)
    DATABASE_URL: str
    REDIS_URL: str
    SECRET_KEY: str
    
    # ì„ íƒì  í™˜ê²½ë³€ìˆ˜ (ê¸°ë³¸ê°’ ì œê³µ)
    CLERK_SECRET_KEY: Optional[str] = None
    GEMINI_API_KEY: Optional[str] = None
    MOLIT_API_KEY: Optional[str] = None
    
    class Config:
        env_file = ".env"
        env_file_encoding = "utf-8"
        case_sensitive = True
```

---

## ğŸ“Š ê¸°ìˆ  ìŠ¤íƒ ìš”ì•½

| ê³„ì¸µ | ê¸°ìˆ  | ë²„ì „ | íŠ¹ì§• |
|------|------|------|------|
| **Frontend** | React | 19.2.3 | Concurrent Rendering, Automatic Batching |
| | TypeScript | 5.8.2 | ì •ì  íƒ€ì… ì•ˆì „ì„± |
| | Vite | 6.2.0 | HMR, ESBuild ë²ˆë“¤ë§ |
| | Kakao Maps SDK | - | ì§€ë„ ì‹œê°í™”, í´ëŸ¬ìŠ¤í„°ë§ |
| | Highcharts | 12.5.0 | ì¸í„°ë™í‹°ë¸Œ ì°¨íŠ¸ |
| **Backend** | FastAPI | - | ASGI, ë¹„ë™ê¸° ì§€ì› |
| | SQLAlchemy | 2.0 | ë¹„ë™ê¸° ORM |
| | Pydantic | v2 | ë°ì´í„° ê²€ì¦ |
| **Database** | PostgreSQL | 15 | ê´€ê³„í˜• DB |
| | PostGIS | 3.3 | ê³µê°„ ë°ì´í„° ì²˜ë¦¬ |
| | Redis | 7 | ìºì‹±, ì„¸ì…˜ |
| **AI/ML** | Google Gemini | 2.5-flash | ìì—°ì–´ ì²˜ë¦¬, í…ìŠ¤íŠ¸ ìƒì„± |
| **DevOps** | Docker | - | ì»¨í…Œì´ë„ˆí™” |
| | GitHub Actions | - | CI/CD |
| | Prometheus | - | ë©”íŠ¸ë¦­ ìˆ˜ì§‘ |
| | Grafana | - | ëª¨ë‹ˆí„°ë§ ëŒ€ì‹œë³´ë“œ |
| **ì¸ì¦** | Clerk | - | JWT ê¸°ë°˜ ì¸ì¦ |

---

## ğŸ¯ í•µì‹¬ ê¸°ìˆ ì  ì„±ê³¼

1. **ë¹„ë™ê¸° ì•„í‚¤í…ì²˜**: FastAPI + SQLAlchemy ë¹„ë™ê¸° ì¡°í•©ìœ¼ë¡œ ë†’ì€ ë™ì‹œì„± ì²˜ë¦¬
2. **ê³µê°„ ë°ì´í„° ì²˜ë¦¬**: PostGIS ê¸°ë°˜ ì •í™•í•œ ê±°ë¦¬ ê³„ì‚° ë° ë°˜ê²½ ê²€ìƒ‰
3. **ì§€ëŠ¥í˜• ìºì‹±**: Redis + Graceful Degradationìœ¼ë¡œ ì•ˆì •ì ì¸ ì„œë¹„ìŠ¤
4. **AI í†µí•©**: Gemini APIë¥¼ í™œìš©í•œ ìì—°ì–´ ê²€ìƒ‰ ë° ì½˜í…ì¸  ìƒì„±
5. **ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§**: Prometheus + Grafana ê¸°ë°˜ ì„±ëŠ¥ ê´€ì¸¡
6. **ìë™í™”ëœ ë°°í¬**: GitHub Actions + Dockerë¡œ ë¬´ì¤‘ë‹¨ ë°°í¬

---

*ì´ ë¬¸ì„œëŠ” í”„ë¡œì íŠ¸ì˜ ê¸°ìˆ ì  êµ¬í˜„ ì„¸ë¶€ì‚¬í•­ì„ ì„¤ëª…í•˜ë©°, ì§€ì†ì ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë©ë‹ˆë‹¤.*
